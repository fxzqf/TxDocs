<!DOCTYPE html>
<html lang="zh-cn">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>在线表格</title>
  <style>
    * {
      margin: 0;
      padding: 0;
    }

    html,
    body {
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    #custom-mount {
      width: 100%;
      height: 100%;
    }
  </style>
</head>

<body>
  <div id="custom-mount"></div>
  <script src="./js/web-office-sdk-v1.1.19.umd.js"></script>
  <script src="./js/app.js"></script>


  <!-- 注意添加 text/babel，否则无法编译 -->
  <!--
  <script text="text/babel">
<<<<<<< HEAD
   
    const jssdk = WebOfficeSDK.config({
      url: 'https://www.kdocs.cn/l/cagNbUYJX08f?R=%2FS%2F4',
      mount: document.querySelector('.custom-mount'),
      tokenData: { token: "21bc4e20a760fca0cd766a0bf58bc082" },
      mode: 'nomal',  //nomal或simple
      // 通用选项，所有类型文档适用
      commonOptions: {
        isShowTopArea: true, // 隐藏顶部区域（头部和工具栏）
        isShowHeader: true, // 隐藏头部区域
      },
      //头部左侧功能按钮
      commandBars: [
        {
          cmbId: 'MobileHeader', // 组件 ID
          attributes: {
            visible: true, // 显示组件
            enable: true, // 禁用组件，组件显示但不响应点击事件
          },
        },
      ],
    });

    window.onload = async function () {

      //jssdk.ApiEvent.AddApiEventListener("fileOpen", (data) => { console.log("fileOpen: ", data); });
      //jssdk.ApiEvent.AddApiEventListener("Worksheet_SelectionChange",(data) => { console.log("Worksheet_SelectionChange: ", (data)); });
      await jssdk.ready();
      window.App = jssdk.Application;

      //jssdk.ApiEvent.AddApiEventListener("Worksheet_SelectionChange",async (data) => { console.log("Worksheet_SelectionChange: ",await (data)); });







      window.App.Sub.Worksheet_Activate = async () => { console.log('ActiveSheet：', await window.App.ActiveSheet.Name); };
      window.App.Sub.Worksheet_SelectionChange = async () => { console.log('Worksheet_SelectionChange：', await (window.App.Selection.Text)); };

      // 控制手机端的分享菜单隐藏
      //const moreMenus = await window.App.CommandBars('ShareLink');
      //moreMenus.Visible = false;


      const operatorsInfo = await window.App.ActiveWorkbook.GetOperatorsInfo()
      console.log(operatorsInfo)


    }

      //https://account.wps.cn/?qrcode=kdocs&logo=kdocs&accessid=AK20210823OPGONG&from=v1-web-kdocs-login&cb=https%3A%2F%2Faccount.wps.cn%2Fapi%2Fv3%2Fsession%2Fcorrelate%2Fredirect%3Ft%3D1661241340991%26appid%3D375024576%26cb%3Dhttps%253A%252F%252Fwww.kdocs.cn%252FsingleSign4CST%253Fcb%253Dhttps://www.kdocs.cn/l/coO0iEfp4s1c
      ///用户未登录跳转
      //if(window.jssdk.iframeReady) console.log("Good"); else window.jssdk.iframe.src="https://account.wps.cn/?qrcode=kdocs&logo=kdocs&accessid=AK20210823OPGONG&from=v1-web-kdocs-login&cb=https%3A%2F%2Faccount.wps.cn%2Fapi%2Fv3%2Fsession%2Fcorrelate%2Fredirect%3Ft%3D1661241340991%26appid%3D375024576%26cb%3Dhttps%253A%252F%252Fwww.kdocs.cn%252FsingleSign4CST%253Fcb%253Dhttps://www.kdocs.cn/l/coO0iEfp4s1c";
      //window.jssdk.ApiEvent.AddApiEventListener("fileOpen", (data) => {console.log("fileOpen: ", data);});
      //window.jssdk.ApiEvent.AddApiEventListener("error", (data) => {console.log("Error: ", data);});
      //const refreshFunc = () => {
      // token 为应用文档的请求中携带给你的服务端进行自行鉴权
      //return Promise.resolve({
      //  token: '21bc4e20a760fca0cd766a0bf58bc082',
      //  timeout: 10*60*1000
      //})
=======
    window.onload =new app();
     
    /*
        window.onload = async function () {
    
          window.jssdk = WebOfficeSDK.config({
            url: 'https://www.kdocs.cn/l/coO0iEfp4s1c',
            mount: document.querySelector('.custom-mount'),
            tokenData: { token: "21bc4e20a760fca0cd766a0bf58bc082" },
            mode: 'nomal',  //nomal或simple
            // 通用选项，所有类型文档适用
            commonOptions: {
              isShowTopArea: true, // 隐藏顶部区域（头部和工具栏）
              isShowHeader: true, // 隐藏头部区域
            },
            //头部左侧功能按钮
            commandBars: [
              {
                cmbId: 'MobileHeader', // 组件 ID
                attributes: {
                  visible: true, // 显示组件
                  enable: true, // 禁用组件，组件显示但不响应点击事件
                },
              },
            ],
          });
    
    
          //jssdk.ApiEvent.AddApiEventListener("fileOpen", (data) => { console.log("fileOpen: ", data); });
          //jssdk.ApiEvent.AddApiEventListener("Worksheet_SelectionChange",(data) => { console.log("Worksheet_SelectionChange: ", (data)); });
          if (window.jssdk.iframeReady) console.log("Good"); else window.jssdk.iframe.src = "https://account.wps.cn/?qrcode=kdocs&logo=kdocs&accessid=AK20210823OPGONG&from=v1-web-kdocs-login&cb=https%3A%2F%2Faccount.wps.cn%2Fapi%2Fv3%2Fsession%2Fcorrelate%2Fredirect%3Ft%3D1661241340991%26appid%3D375024576%26cb%3Dhttps%253A%252F%252Fwww.kdocs.cn%252FsingleSign4CST%253Fcb%253Dhttps://www.kdocs.cn/l/coO0iEfp4s1c";
          await window.jssdk.ready();
    
    
    
          
    
    
          window.App = jssdk.Application;
    
          //jssdk.ApiEvent.AddApiEventListener("Worksheet_SelectionChange",async (data) => { console.log("Worksheet_SelectionChange: ",await (data)); });
    
    
    
    
    
    
    
          window.App.Sub.Worksheet_Activate = async () => { console.log('ActiveSheet：', await window.App.ActiveSheet.Name); };
          window.App.Sub.Worksheet_SelectionChange = async () => { console.log('Worksheet_SelectionChange：', await (window.App.Selection.Text)); };
    
          // 控制手机端的分享菜单隐藏
          //const moreMenus = await window.App.CommandBars('ShareLink');
          //moreMenus.Visible = false;
    
    
          const operatorsInfo = await window.App.ActiveWorkbook.GetOperatorsInfo()
          console.log(operatorsInfo)
    
    
        }
    
          //https://account.wps.cn/?qrcode=kdocs&logo=kdocs&accessid=AK20210823OPGONG&from=v1-web-kdocs-login&cb=https%3A%2F%2Faccount.wps.cn%2Fapi%2Fv3%2Fsession%2Fcorrelate%2Fredirect%3Ft%3D1661241340991%26appid%3D375024576%26cb%3Dhttps%253A%252F%252Fwww.kdocs.cn%252FsingleSign4CST%253Fcb%253Dhttps://www.kdocs.cn/l/coO0iEfp4s1c
          ///用户未登录跳转
          //if(window.jssdk.iframeReady) console.log("Good"); else window.jssdk.iframe.src="https://account.wps.cn/?qrcode=kdocs&logo=kdocs&accessid=AK20210823OPGONG&from=v1-web-kdocs-login&cb=https%3A%2F%2Faccount.wps.cn%2Fapi%2Fv3%2Fsession%2Fcorrelate%2Fredirect%3Ft%3D1661241340991%26appid%3D375024576%26cb%3Dhttps%253A%252F%252Fwww.kdocs.cn%252FsingleSign4CST%253Fcb%253Dhttps://www.kdocs.cn/l/coO0iEfp4s1c";
          //window.jssdk.ApiEvent.AddApiEventListener("fileOpen", (data) => {console.log("fileOpen: ", data);});
          //window.jssdk.ApiEvent.AddApiEventListener("error", (data) => {console.log("Error: ", data);});
          //const refreshFunc = () => {
          // token 为应用文档的请求中携带给你的服务端进行自行鉴权
          //return Promise.resolve({
          //  token: '21bc4e20a760fca0cd766a0bf58bc082',
          //  timeout: 10*60*1000
          //})*/
>>>>>>> 9add79d9c37f54c163bf48847230b602a282c6f2
  </script>
  -->
</body>

</html>